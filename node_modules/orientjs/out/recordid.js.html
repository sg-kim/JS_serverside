<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: recordid.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: recordid.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

/**
 * # Record ID
 *
 * Represents a Record ID in a document.
 * Used to differentiate between actual record ids and strings that merely look like them.
 * Without this, it is impossible to differentiate between `'#1:12'` the string and `#1:12` the record id.
 *
 * @param {String|Array|Object} input The input to parse.
 *
 * @example convert a string to a RecordID instance
 *
 *    var rid = RecordID('#1:1');
 *    console.log(rid); // => {cluster: 1, position: 1}
 *    console.log('ID:' + rid); // => "ID:#1:1"
 *
 * @example convert an array of strings to an an array of record ids
 *
 *    var rids = RecordID(['#1:1', '#1:2', '#1:3']);
 *    console.log(rids); // => [{cluster: 1, position: 1}, {cluster: 1, position: 2, {cluster: 1, position: 3}]
 *    console.log(rids.join(', ')); // "#1:1, #1:2, #1:3"
 *
 * @example check that a RID is valid
 *
 *    RecordID.isValid('#1:12'); // => true
 *    RecordID.isValid('not a record id'); // => false
 *
 */
function RecordID(input) {
  if (!(this instanceof RecordID)) {
    return new RecordID(input);
  }

  this.cluster = null;
  this.position = null;

  if (input) {
    if (typeof input === 'string') {
      var parsed = RecordID.parse(input);
      if (parsed) {
        return parsed;
      }
    }
    else if (Array.isArray(input)) {
      return input.map(function (item) {
        return new RecordID(item);
      });
    }
    else if (typeof input === 'object') {
      if (input.cluster == +input.cluster) {
        this.cluster = +input.cluster;
      }
      if (input.position == +input.position) {
        this.position = +input.position;
      }
    }
  }
}

/**
 * Convert the record id back into a string when being compared or serialized.
 * @return {String} The string representation of the Record ID
 */
RecordID.prototype.valueOf = RecordID.prototype.toString = RecordID.prototype.toJSON = function () {
  return '#' + this.cluster + ':' + this.position;
};

/**
 * Determine whether the record id is valid.
 * @return {Boolean} true if the record id is valid.
 */
RecordID.prototype.isValid = function () {
  return this.cluster == +this.cluster &amp;&amp; this.position == +this.position;
};

RecordID.prototype.isTemporary = function () {
  return this.position &lt; -1;
};

/**
 * Determine whether the record id is equal to another.
 *
 * @param  {String|RID} rid  The RID to compare with.
 * @return {Boolean}         If the RID matches, then true.
 */
RecordID.prototype.equals = function (rid) {
  if (rid === this) {
    return true;
  }
  else if (typeof rid === 'string') {
    return this.toString() === rid;
  }
  else if (rid &amp;&amp; rid['@rid']) {
    return this.equals(rid['@rid']);
  }
  else if (rid instanceof RecordID) {
    return rid.cluster === this.cluster &amp;&amp; rid.position === this.position;
  }
  else if ((rid = RecordID.parse(rid))) {
    return rid.cluster === this.cluster &amp;&amp; rid.position === this.position;
  }
  else {
    return false;
  }
};

/**
 * Parse a record id into a RecordID object.
 *
 * @param  {String|Array|Object}          input The input to parse.
 * @return {RecordID|RecordID[]|Boolean}        The parsed RecordID instance(s)
 *                                              or false if the record id could not be parsed
 */
RecordID.parse = function (input) {
  if (input &amp;&amp; typeof input === 'object') {
    if (Array.isArray(input)) {
      return input.map(RecordID.parse)
        .filter(function (item) {
          return item;
        });
    }
    else if (input.cluster != null &amp;&amp; input.position != null) {
      return new RecordID(input);
    }
    else {
      return false;
    }
  }
  var matches = /^#(-?\d+):(-?\d+)$/.exec(input);
  if (!matches) {
    return false;
  }
  else {
    return new RecordID({
      cluster: +matches[1],
      position: +matches[2]
    });
  }
};

/**
 * Determine whether the given input is a valid record id.
 * @param  {String|Array|Object|RecordID}  input The record id to check.
 * @return {Boolean}
 */
RecordID.isValid = function (input) {
  var i, total;
  if (input instanceof RecordID) {
    return input.isValid();
  }
  else if (typeof input === 'string') {
    return /^#(-?\d+):(-?\d+)$/.test(input);
  }
  else if (input &amp;&amp; Array.isArray(input)) {
    total = input.length;
    for (i = 0; i &lt; total; i++) {
      if (!RecordID.isValid(input[i])) {
        return false;
      }
    }
    return i ? true : false;
  }
  else if (input &amp;&amp; typeof input === 'object') {
    return input.cluster == +input.cluster &amp;&amp; input.position == +input.position;
  }
  else {
    return false;
  }
};

RecordID.isTemporary = function (input) {
  var i, total;
  if (input instanceof RecordID) {
    return input.isTemporary();
  }
  else if (typeof input === 'string') {
    return /^#(-?\d+):(-\d+)$/.test(input);
  }
  else if (input &amp;&amp; Array.isArray(input)) {
    total = input.length;
    for (i = 0; i &lt; total; i++) {
      if (!RecordID.isTemporary(input[i])) {
        return false;
      }
    }
    return i ? true : false;
  }
  else if (input &amp;&amp; typeof input === 'object') {
    return input.cluster &lt; 0 &amp;&amp; input.position &lt; -1;
  }
  else {
    return false;
  }
};
/**
 * Return a record id for a given cluster and position.
 *
 * @param  {Integer} cluster  The cluster ID.
 * @param  {Integer} position The position.
 * @return {String}           The record id.
 */
RecordID.toRid = function (cluster, position) {
  return "#" + cluster + ":" + position;
};

module.exports = RecordID;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="global.html#Long">Long</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ArrayLike">ArrayLike</a></li><li><a href="global.html#augment">augment</a></li><li><a href="global.html#Bag">Bag</a></li><li><a href="global.html#clone">clone</a></li><li><a href="global.html#deprecate">deprecate</a></li><li><a href="global.html#encode">encode</a></li><li><a href="global.html#escape">escape</a></li><li><a href="global.html#extend">extend</a></li><li><a href="global.html#getOrientDbUTCDate">getOrientDbUTCDate</a></li><li><a href="global.html#jsonify">jsonify</a></li><li><a href="global.html#prepare">prepare</a></li><li><a href="global.html#readLong">readLong</a></li><li><a href="global.html#RecordID">RecordID</a></li><li><a href="global.html#requiresParens">requiresParens</a></li><li><a href="global.html#size">size</a></li><li><a href="global.html#type">type</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Jun 15 2018 12:28:31 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
